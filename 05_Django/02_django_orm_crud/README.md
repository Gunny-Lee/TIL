# Django Model (ORM)

## 1. Model

- 장고 MTV 패턴
  - **Model**
    - 특정한 데이터의 구조(모양)에 대한 정보를 가지고 있다.(-> 데이터의 모양을 정의하는 곳)
    - 하나의 모델 클래스는 실제 DB에는 하나의 테이블로 매핑된다.
    - 컬럼들에 대한 정보, 해당 데이터에 대한 정보를 정의하는 곳
  - Template
  - View
- Model 로직
  - 데이터베이스 컬럼(열)과 어떠한 타입으로 정의할 것인지에 대한 정보를 `django.db.models`라는 곳에서 상속받아서 정의한다.
  - 모든 필드들은 `NOT NULL` 조건이 붙는다.
  - 각각의 클래스 변수는 데이터베이스 필드를 나타낸다.

### 1.1 Migration

- `makemigrations`
  - 실제 데이터베이스 테이블을 만들기 전에 설계도를 그려보는 작업
    - Python 코드로 데이터베이스 설계도를 작성한다.
  - migrations 폴더에서 확인해 볼 수 있다.(`0001_initial.py`, ...)
- `sqlmigrate`
  - 데이터베이스에 실제로 반영하기 전에 **설계한 Python 코드가 SQL문으로 바뀐 모습을 확인**해 볼 수 있다.
- `showmigrations`
  - migration 설계도를 작성했는데, 이 **설계도가 실제 DB에 반영되었는지 여부를 확인**
- `migrate`
  - `makemigrations`로 만든 **설계도를 실제 데이터베이스(sqlite3)에 반영**한다.
  - 모델의 변경사항과 데이터베이스 스키마를 동기화한다.

## 2. ORM - CRUD

- ORM이 리턴되는 형식
  - QuerySet : 다수의 객체가 담김 (파이썬 리스트 다루는 것과 비슷)
  - Query : 단일 객체
- `모델명.objects.명령`
  - objects : 모델 클래스 정보를 토대로 실제 데이터베이스에 쿼리(SQL)를 날려서 데이터베이스와 의사소통 하는 통역사(매니저) 역할
- **우리가 ORM을 사용하는 이유?**
  - SQL문에 종속되지 않고 데이터를 객체 형태로 다루기 위해 (프로그래밍 언어만 알아도 DB 핸들링 가능)